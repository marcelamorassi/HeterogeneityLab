---
title: "Lab2_Script"
author: "Marcela Morassi"
date: "9/23/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


StartUp
```{r}
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
library(rcompanion)
library(dplyr)
library(ggplot2)
library(ggforce)
library(vegan)

setwd("C:/Users/Marcela Morassi/Documents/Github/HeterogeneityLab")

data <- read.csv("full_data_F21.csv")


```

Calibrating Canopy Estimates
```{r}
regression = lm(Percent_Cnpy_Open ~ Canopy, data = data)
regression
summary(regression)
# Note that you should go with the "Multiple R-squared," not "Adjusted R-squared"

ggplot(data = data, aes(x=Canopy, y=Percent_Cnpy_Open)) + geom_point() + 
  geom_smooth(method = "lm", se = FALSE, color = "grey") +
  geom_jitter(height = 0, width = .15) +
  theme_classic() + xlab("Subjective Canopy Cover") + ylab("Percent Openness")

ggsave("Calibrating Canopy Estimates.png")

```

Relationship between canopy and ground cover
```{r}
#canopy 0
zero_canopy <- data %>% 
  filter(Canopy == 0)

table_zero <- xtabs(~Ground + Shrub, data= zero_canopy)
 
chisq.test(table_zero)

canopy0 <- select(filter(data, Canopy == 0), Shrub, Ground)

table(canopy0)

chisq.test(canopy0)

#canopy 1
one_canopy <- data %>% 
  filter(Canopy == 1)

table_one <- xtabs(~Ground + Shrub, data= one_canopy)
 
chisq.test(table_one)

canopy1 <- select(filter(data, Canopy == 1), Shrub, Ground)

table(canopy1)

chisq.test(canopy1)

#canopy 2
two_canopy <- data %>% 
  filter(Canopy == 2)

table_two <- xtabs(~Ground + Shrub, data= two_canopy)
 
chisq.test(table_two)

canopy2 <- select(filter(data, Canopy == 2), Shrub, Ground)

table(canopy2)

chisq.test(canopy2)

#canopy 3
three_canopy <- data %>% 
  filter(Canopy == 3)

table_three <- xtabs(~Ground + Shrub, data= three_canopy)
 
chisq.test(table_three)

canopy3 <- select(filter(data, Canopy == 3), Shrub, Ground)

table(canopy3)

chisq.test(canopy3)

#PROPORTIONAL TABLES

#canopy 0
prop0 <- prop.table(canopy0)
prop0
 
```









